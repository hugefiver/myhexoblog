---
title: “学宝”虚拟机调教日记（二）
date: 2018-04-02 21:50:07
categories:
	- 日常
	- 随便写写
tags:
	- 日常
	- 学宝虚拟机
	- 惊了，题目竟然会和谐
toc: false
---
&emsp;**题目和谐就和谐吧，反正这个系列就是我自己写着玩的，不需要转发到其他平台**
<!--more-->

### 写在前面
**本文不是面向大众的，只是一个记录，看不懂或不感兴趣请直接关掉，谢谢**

前面那篇只是这个系列的基础，只是顺带讲讲而已。

其实这篇才是我想写的。这个系列是我专业课~~划水~~学习时，折腾学宝玩的时候的一些玩法的记录。
```
划水和摸鱼是人类进步的阶梯。Rua！
					——大五
```
{% raw %}
<link rel="stylesheet" href="https://resource.rurilove.moe/statics/aplayer/APlayer.min.css">
<script src="https://resource.rurilove.moe/statics/aplayer/APlayer.min.js"></script>
<div id="player" class="aplyer" style="width: 100%;margin: auto "></div>
<script type="text/javascript">
	var ap = new APlayer({ 
	    element: document.getElementById('player'), 
	    narrow: false, 
	    autoplay: true, 
	    showlrc: false, 
	    music: { 
	        title: 'Endless Journey (instrumental)', 
	        author: '水瀬いのり', 
	        url: 'https://resource.rurilove.moe/musics/01.mp3', 
	        pic: 'https://resource.rurilove.moe/images/mufront/01.jpg' 
	    } 
	}); 
	ap.init(); 
</script>
{% endraw %}

### 正文
上学期刚刚接触学宝虚拟机时就试过通过上篇文的方法连上虚拟机，竟然一下就连上了，由此我知道了学校校园网内部的直通性，即大家都处于同一网络，不存在二级网关的阻挡。当时我就想啊，能不能由本机转发虚拟机的所有流量让处于内网的虚拟机也能上外网呢。可是当时我在用Windows，不太好搭代理, 于是计划就搁置了。

后来，基本已经摆脱Windows的束缚，投入了开源系统的怀抱。同时，我也逐渐接触了`Project V`这个软件。~~这个软件是一个由`golang`开发支持几乎全平台的代理协议**框架**，它自带自主开发的`vmess`协议，同时开发者也可以向框架中添加其他协议，其设计之初是以科学上网为目标的。不过呢，它的功能似乎不止于此。这个软件区别就是，它的服务端和客户端是相同的。当他被连接时是服务端，它连接服务端时是客户端。（全部由配置文件区分）反正很灵活就是了，你甚至可以在它支持的协议中随意组合使它同时开启和连接多个服务。~~

感觉介绍有点长...下面就进入正题吧。

首先从 ~~gayhub~~ github的仓库中下载`release`中的最新版本。项目名称是`v2ray-core`。解压后在目录中打开终端。

新建一个名为`config.json`的文件，把自己的配置粘进去。我贴一下我的配置：
```json
  "inbound": {
    "listen": "0.0.0.0", //如果只想对本机开放而不想对局域网开放改为 "127.0.0.1"
    "port": 1080, //本地开放端口
    "protocol": "socks", //使用socks协议
    "settings": {
      "auth": "noauth",
      "udp": true
    }
  },
  "outbound": {
    "protocol": "vmess",
    "settings": {
      "vnext": [
        //这里是我的代理科学上网配置，已删除
      ]
    },
    "tag": "proxy",
    "streamSettings": {
     //同上
     }
  },
  "outboundDetour": [
    {
      "protocol": "freedom",
      "settings": {},
      "tag": "direct"
    }
  ],
  "routing": {
    "strategy": "rules",
    "settings": {
      "domainStrategy": "IPIfNonMatch",
      "rules": [
        {
          "type": "field",
          "ip": [
            "geoip:private"
          ],
          "outboundTag": "direct"
        },
        {
          "type": "chinaip",
          "outboundTag": "direct"
        },
        {
          "type": "chinasites",
          "outboundTag": "direct"
        }
      ]
    }
  }
}
```

然后在终端输入`./v2ray`运行程序。此时，本地可以看做一个`socks`代理服务器，只需要在虚拟机连接即可。我们先记下本机的局域网ip。具体怎么看自行百度或Google。

进入虚拟机之后， ~~一片虚无~~ 我思考了片刻：要怎么连上代理来着？！

最后我决定使用`chrome`的插件（据说系统可以设置代理来着，可是我死活连不上，可能用http代理要好一些）。还好我们虚拟机自带了chrome（虽然XP支持的版本很老），chrome有很多的相关插件，我就用了我本机用的这个（不过看起来版本有点老）。
![01.png](https://i.yusa.me/nGSqE0vzaKza.png)
添加一个配置，填上本机的局域网ip和代理的端口就行了，`Turn ON!!!`
![02.png](https://i.yusa.me/zKf74myRErM9.png)
上百度，
![03.png](https://i.yusa.me/0BhYXj8r3Qxq.png)
下Python，一气呵成
![04.png](https://i.yusa.me/y1fG68p3jMWd.png)
不过看视频够呛

有点小问题，chrome一直提示访问网页不安全，可能是证书问题吧。

### 最后顺带提一下
其实大部分高校都会提供ipv6，我们学校也不例外。ipv6基本是没有坑爹的防火墙的，所以可以直接的上Google、YouTube这种支持ipv6的网站的。不过解析ipv6地址需要支持这个的DNS，显然我们学校的是没有的，不过我们可以自己换一个嘛。

在网络适配器中启用ipv6协议，填上ipv6 DNS，例如下面这几个：
```
Google: 2001:4860:4860::8888
Google: 2001:4860:4860::8844
```
然后访问`ipv6.google.com`或直接`www.google.com`。如果访问不了试试把ipv4 协议停掉，访问成功后再打开 ~~（基于Chrome优先访问ipv6的都市传说）~~。个人觉得ipv6就算墙也不会很严重的。
P.S. 就算不登录校园网账号也是会分配ipv6地址的~~，我开学那几天就靠着自己搭的6转4服务过来的~~。